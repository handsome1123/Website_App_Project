<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab test1</title>
    <link rel="stylesheet" href="/public/css/bootstrap.min.css">
    <script src="/public/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="Editreservation-staff.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.33/dist/sweetalert2.all.min.js"></script>
</head>

<style>
    .lato-light {
        font-family: 'Arial', sans-serif;
        font-weight: 400;
        font-style: normal;
    }
    
    .navbar {
        padding-bottom: 0;
    }
    
    ul {
        display: flex;
        gap: 4rem;
        list-style: none;
        padding-bottom: 0%;
    }
    
    .navbar {
        padding-bottom: 0px;
    }
    
    .nav {
        justify-content: center;
    }
    
    .navbar-brand {
        text-decoration: none;
        color: black;
        
        position: relative;
        transition: all 0.3s ease;
        padding-bottom: 0%;
    
    }
    
    .navbar-brand:hover {
        color: #4c1b9a;
        padding-bottom: 0%;
    }
    
    .navbar-brand::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 2px;
        background: #4c1b9a;
        border-radius: 5px;
        transform: scaleX(0);
        transition: all 0.6s ease;
        bottom: 0;
        left: 0;
        padding-bottom: 0px;
    }
    
    .navbar-brand:hover::before {
        transform: scaleX(1);
        padding-bottom: 0%;
    }
    
    #Logout {
        background: rgb(68, 43, 206);
        padding-left: 13px;
        font-size: 20px;
        color: white;
        text-align: end;
    }
    
    #Logout:hover {
        background: rgb(230, 63, 63);
        padding-left: 13px;
        font-size: 20px;
        color: white;
    }
    
    .navbar {
    
        margin-bottom: 0px;
        padding-bottom: 0%;
        justify-content: center;
    }
    
    .s {
        text-decoration: none;
    }
    
    .rainbow-text {
        background-image: linear-gradient(to right, #2B27A4,#4c1b9a,#90279B);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        /* For Safari */
       /* background-size: 400%;
        /* Adjust based on text length */
       /* animation: rainbow-animation 5s infinite linear;
        /* Adjust duration as needed */
    }
    
    #Editreservation {
        color: #4c1b9a;
        text-decoration: underline;
        cursor: not-allowed;
    }
    @media (max-width: 767px) {
        .navbar-brand {
          font-size: 17px; /* Decrease font size */
        }
      }
      
      /* For medium devices (e.g., tablets) */
      @media (min-width: 768px) and (max-width: 991px) {
        .navbar-brand {
          font-size: 20px; /* Adjust font size */
        }
      }
      
      /* For large devices (e.g., desktops) */
      @media (min-width: 992px) {
        .navbar-brand {
          font-size: 28px; /* Default font size */
        }
      }
      nav{
        background: linear-gradient(to right, #ffffff,#9DA2AE);
      }
      td img {
        display: block;
        margin: 0 auto;
    }
</style>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light pt-4 sticky-top">
        <ul>
            <li>
                <h1 class="rainbow-text">Roommeetee</h1>
            </li>
            <li><a href="roomlist-staff.html" class="navbar-brand float-end" id="Roomlist">Room list</a></li>
            <li><a href="#" class="navbar-brand float-end" id="Editreservation">Edit Reservation</a></li>
            <li><a href="Dashboard-staff.html" class="navbar-brand float-end" id="Dashboard">Dashboard</a></li>
            <li><a href="History-staff.html" class="navbar-brand float-end" id="History">History</a></li>
            <li><button class="btn" id="Logout">Logout</button></li>
            <li></li>
        </ul>
    </nav>

    <!-- Table -->
    <div class="mt-3 table-responsive">
        <button class="btn btn-success float-end mb-3" id="btnAdd">Add</button>
        <table class="table table-striped table-bordered">
        </table>
    </div>

    <!-- Add/Edit modal -->
    <div class="modal fade" id="modalAddEdit" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false"
        role="dialog">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitleId">Add Room</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control mb-2" id="txtName" placeholder="Name">
                    <select required class="form-select mb-2" id="txtTimeSlot">
                        <option value="" disabled selected hidden>Select Time Slot</option>
                        <option value="08.00-10.00">08.00-10.00</option>
                        <option value="10.00-12.00">10.00-12.00</option>
                        <option value="13.00-15.00">13.00-15.00</option>
                        <option value="15.00-17.00">15.00-17.00</option>
                    </select>
                    <h4 class="mt-3">Room Size</h4>
                    <div class="form-check mb-2">
                        
                        <input class="form-check-input" type="radio" name="size" value="" id="chkSize1">
                        <label class="form-check-label" for="chkSize1">Small Room</label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="size"  value="" id="chkSize2">
                        <label class="form-check-label" for="chkSize2">Medium Room</label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="size"  value="" id="chkSize3">
                        <label class="form-check-label" for="chkSize2">Large Room</label>
                    </div>
                 
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button id="btnSave" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- End of Add/Edit modal -->

    <!-- JavaScript -->
    <script>
        var rooms = [
            {
                id: 1,
                name: 'Meeting room1',
                time: '08.00-10.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 2,
                name: 'Meeting room1',
                time: '10.00-12.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 3,
                name: 'Meeting room1',
                time: '13.00-15.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 4,
                name: 'Meeting room1',
                time: '15.00-17.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 5,
                name: 'Meeting room2',
                time: '08.00-10.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 6,
                name: 'Meeting room2',
                time: '10.00-12.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 7,
                name: 'Meeting room2',
                time: '13.00-15.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 8,
                name: 'Meeting room2',
                time: '15.00-17.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 9,
                name: 'Meeting room3',
                time: '08.00-10.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 10,
                name: 'Meeting room3',
                time: '10.00-12.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id:11,
                name: 'Meeting room3',
                time: '13.00-15.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id:12,
                name: 'Meeting room3',
                time: '15.00-17.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 13,
                name: 'Meeting room4',
                time: '08.00-10.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 14,
                name: 'Meeting room4',
                time: '10.00-12.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 15,
                name: 'Meeting room4',
                time: '13.00-15.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 16,
                name: 'Meeting room4',
                time: '15.00-17.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 17,
                name: 'Meeting room5',
                time: '08.00-10.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 18,
                name: 'Meeting room5',
                time: '10.00-12.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 19,
                name: 'Meeting room5',
                time: '13.00-15.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 20,
                name: 'Meeting room5',
                time: '15.00-17.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 21,
                name: 'Meeting room6',
                time: '08.00-10.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 22,
                name: 'Meeting room6',
                time: '10.00-12.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 23,
                name: 'Meeting room6',
                time: '13.00-15.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 24,
                name: 'Meeting room6',
                time: '15.00-17.00',
                disabled: false,
                size:"Medium Size"
            },
            {
                id: 25,
                name: 'Meeting room7',
                time: '08.00-10.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 26,
                name: 'Meeting room7',
                time: '10.00-12.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 27,
                name: 'Meeting room7',
                time: '13.00-15.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id: 28,
                name: 'Meeting room7',
                time: '15.00-17.00',
                disabled: false,
                size:"Large Size"
            },
            {
                id:29,
                name: 'Meeting room8',
                time: '08.00-10.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id:30,
                name: 'Meeting room8',
                time: '10.00-12.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id:31,
                name: 'Meeting room8',
                time: '13.00-15.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id:32,
                img:'/public/img/Smallroom.jpg',
                name: 'Meeting room8',
                time: '15.00-17.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 33,
                name: 'Meeting room9',
                time: '08.00-10.00',
                disabled: false,
                size:"Large Size"

            },
            {
                id: 34,
                name: 'Meeting room9',
                time: '10.00-12.00',
                disabled: false,
                size:"Large Size"

            },
            {
                id: 35,
                name: 'Meeting room9',
                time: '13.00-15.00',
                disabled: false,
                size:"Large Size"

            },
            {
                id: 36,
                name: 'Meeting room9',
                time: '15.00-17.00',
                disabled: false,
                size:"Large Size"

            },
            {
                id: 37,
                name: 'Meeting room10',
                time: '08.00-10.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 38,
                name: 'Meeting room10',
                time: '10.00-12.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 39,
                name: 'Meeting room10',
                time: '13.00-15.00',
                disabled: false,
                size:"Small Size"
            },
            {
                id: 40,
                name: 'Meeting room10',
                time: '15.00-17.00',
                disabled: false,
                size:"Small Size"
            },
            // Add more room objects as needed...
        ];

        var mode = "add";
        var editID = null;
        const modalAddEdit = new bootstrap.Modal(document.querySelector('#modalAddEdit'));

        function readRooms() {
            let output = '<thead class="table-dark"><tr><th class="text-center">Picture</th><th>Name</th><th>Time Slot</th><th>Room Size</th><th>Status</th><th>Action</th></tr></thead><tbody>';
            rooms.forEach(function (room) {
                output += '<tr>';

                    if(room.size==="Small Size"){
                        output += `<td><img src="/public/img/Smallroom.jpg" width="200px" height="120px"></td>`;
                    }
                    else if(room.size==="Medium Size"){
                        output += `<td><img src="/public/img/mediumroom.jpg" width="200px" height="120px"></td>`;
                    }
                    else if(room.size==="Large Size"){
                        output += `<td><img src="/public/img/Largestroom.jpg" width="200px" height="120px"></td>`;
                    }
                output += `<td>${room.name}</td>`;
                output += `<td>${room.time}</td>`;
                output += `<td>${room.size}</td>`;
                output += `<td>${room.disabled ? 'Disabled' : 'Enabled'}</td>`;
                if (room.disabled) {
                    output += `<td><button class="btn btn-success btnEnable me-2" id=${room.id}>Enable</button>`;
                } else {
                    output += `<td><button class="btn btn-danger btnDisable me-2" id=${room.id}>Disable</button>`;
                }
                output += `<button class="btn btn-primary btnEdit me-2" id=${room.id}>Edit</button></td>`;
                output += '</tr>';
            });
            output += '</tbody>';

            document.querySelector('table').innerHTML = output;

            document.querySelectorAll('.btnEdit').forEach(button => {
                button.onclick = function () {
                    const roomId = parseInt(button.id);
                    editRoom(roomId);
                }
            });
        }

        function disableRoom(id) {
            Swal.fire({
                icon: 'warning',
                title: 'Sure to disable this room?',
                showCancelButton: true,
                confirmButtonText: 'OK'
            }).then((result) => {
                if (result.isConfirmed) {
                    const roomIndex = rooms.findIndex(room => room.id == id);
                    if (roomIndex !== -1) {
                        rooms[roomIndex].disabled = true;
                        readRooms();
                    }
                }
            });
        }

        function enableRoom(id) {
            Swal.fire({
                icon: 'warning',
                title: 'Sure to enable this room?',
                showCancelButton: true,
                confirmButtonText: 'OK'
            }).then((result) => {
                if (result.isConfirmed) {
                    const roomIndex = rooms.findIndex(room => room.id == id);
                    if (roomIndex !== -1) {
                        rooms[roomIndex].disabled = false;
                        readRooms();
                    }
                }
            });
        }
        
        function addRoom() {
    const name = document.querySelector('#txtName').value;
    const timeSlot = document.querySelector('#txtTimeSlot').value;
    const size1 = document.querySelector('#chkSize1').checked;
    const size2 = document.querySelector('#chkSize2').checked;
    const size3 = document.querySelector('#chkSize3').checked;

    let size = '';
     if (size1) {
        size = 'Small Size';
    } else if (size2) {
        size = 'Medium Size';
    } else if (size3) {
        size = 'Large Size';
    }
    else {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Please Choose Room Size.',
        });
        return;
    }

    if (name.trim() === '' || timeSlot.trim() === '') {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Please enter both name and select time slot.',
        });
        return;
    }
    const existingRoom = rooms.find(room => room.name.toLowerCase() === name.toLowerCase() && room.time === timeSlot);
    if (existingRoom) {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Room with the same name and time slot already exists.',
        });
        return;
    }

    Swal.fire({
                icon: 'warning',
                title: 'Sure to Add this room?',
                showCancelButton: true,
                confirmButtonText: 'OK'
            }).then((result) => {
                if (result.isConfirmed) {
    const lastID = rooms.length > 0 ? rooms[rooms.length - 1].id : 0;
    const newRoom = { id: lastID + 1, name: name, time: timeSlot, size: size, disabled: false };
    rooms.push(newRoom);
    modalAddEdit.hide();
    readRooms();
    document.querySelector('#txtName').value = "";
    document.querySelector('#txtTimeSlot').value = "";
}
            });
    
}

        function updateRoom(id, name, time) {
    const size1 = document.querySelector('#chkSize1').checked;
    const size2 = document.querySelector('#chkSize2').checked;
    const size3 = document.querySelector('#chkSize3').checked;
    const roomIndex = rooms.findIndex(room => room.id === id);
    if (roomIndex !== -1) {
        let size = '';
        if (size1) {
            size = 'Small Size';
        } else if (size2) {
            size = 'Medium Size';
        } else if (size3) {
            size = 'Large Size';
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Please choose a Room size.',
            });
            return;
        }

        // Check if a room with the same name and time slot already exists
        const existingRoom = rooms.find(room => room.name.toLowerCase() === name.toLowerCase() && room.time === time && room.id !== id);
        if (existingRoom) {
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Room with the same name and time slot already exists.',
            });
            return;
        }

        // Update room information
        rooms[roomIndex].name = name;
        rooms[roomIndex].time = time;
        rooms[roomIndex].size = size;
        readRooms();
    }
}

        function editRoom(id) {
    const roomIndex = rooms.findIndex(room => room.id === id);
    if (roomIndex !== -1) {
        const room = rooms[roomIndex];
        document.querySelector('#txtName').value = room.name;
        document.querySelector('#txtTimeSlot').value = room.time;
        // Disable the time slot input field
        document.querySelector('#txtTimeSlot').disabled = true;
        // Check the appropriate radio button based on the room size
        if (room.size === 'Small Size') {
            document.querySelector('#chkSize1').checked = true;
        } else if (room.size === 'Medium Size') {
            document.querySelector('#chkSize2').checked = true;
        } else if (room.size === 'Large Size') {
            document.querySelector('#chkSize3').checked = true;
        }
        modalAddEdit.show();
        document.querySelector('#modalTitleId').innerText = "Edit Room " + id;
        mode = "edit";
        editID = id; // Set the global editID variable
    }

    // Check if a room with the same name and time slot already exists
    const newName = document.querySelector('#txtName').value;
    const newTime = document.querySelector('#txtTimeSlot').value;
    const existingRoom = rooms.find(room => room.name.toLowerCase() === newName.toLowerCase() && room.time === newTime && room.id !== id);
    if (existingRoom) {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Room with the same name and time slot already exists.',
        });
        return;
    }

    // Save button confirmation logic
    document.querySelector('#btnSave').onclick = function () {
        Swal.fire({
            title: 'Are you sure you want to save changes?',
            text: 'This action cannot be undone.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, save changes!'
        }).then((result) => {
            if (result.isConfirmed) {
                const newName = document.querySelector('#txtName').value;
                const newTime = document.querySelector('#txtTimeSlot').value;
                const newSize1 = document.querySelector('#chkSize1').checked;
                const newSize2 = document.querySelector('#chkSize2').checked;
                updateRoom(editID, newName, newTime, newSize1, newSize2);
                modalAddEdit.hide();
                mode = "add";
            }
        });
    };
}




        readRooms();

        document.querySelector('#btnAdd').onclick = function () {
            document.querySelector('#txtName').value = "";
            document.querySelector('#txtTimeSlot').value = "";
            document.querySelector('#chkSize1').checked = false;
            document.querySelector('#chkSize2').checked = false;
            modalAddEdit.show();
            document.querySelector('#modalTitleId').innerText = "Add Room";
            mode = "add";
        }

        document.querySelector('#btnSave').onclick = function () {
    
            if (mode == "add") {
                addRoom();
            } else {
                const newName = document.querySelector('#txtName').value;
                const newTime = document.querySelector('#txtTimeSlot').value;
                const newSize1 = document.querySelector('#chkSize1').checked;
                const newSize2 = document.querySelector('#chkSize2').checked;
                updateRoom(editID, newName, newTime, newSize1, newSize2);
                modalAddEdit.hide();
                mode = "add";
            }
        }
   

        document.querySelector('table').onclick = function (e) {
            if (e.target.classList.contains("btnDisable")) {
                disableRoom(e.target.id);
            } else if (e.target.classList.contains("btnEnable")) {
                enableRoom(e.target.id);
            } else if (e.target.classList.contains("btnEdit")) {
                const roomId = parseInt(e.target.id);
                editRoom(roomId);
            }
        }

        document.querySelector('#Logout').onclick = function () {
            Swal.fire({
                title: "Do You Want To Log-Out",
                showCancelButton: true,
                confirmButtonText: "Log-Out",
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = "Login.html"
                } else if (result.isDenied) {
                    Swal.fire("Changes are not saved", "", "info");
                }
            });
        };

    </script>
</body>

</html>